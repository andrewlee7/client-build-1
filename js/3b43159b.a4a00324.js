(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["3b43159b"],{"0374":function(n,e,t){"use strict";t.d(e,"a",function(){return k}),t.d(e,"i",function(){return x}),t.d(e,"s",function(){return T}),t.d(e,"m",function(){return B}),t.d(e,"j",function(){return C}),t.d(e,"n",function(){return P}),t.d(e,"t",function(){return D}),t.d(e,"k",function(){return M}),t.d(e,"h",function(){return F}),t.d(e,"e",function(){return j}),t.d(e,"r",function(){return R}),t.d(e,"q",function(){return W}),t.d(e,"p",function(){return Y}),t.d(e,"o",function(){return E}),t.d(e,"d",function(){return Q}),t.d(e,"c",function(){return N}),t.d(e,"g",function(){return J}),t.d(e,"f",function(){return H}),t.d(e,"l",function(){return L}),t.d(e,"b",function(){return V});var r=t("5640"),i=t.n(r),a=t("9530"),s=t.n(a);function u(){var n=i()(["\n  query CheckUserStatus($id:ID!) {\n    userStatus( where: {id: $id} ) {\n      id\n      userStatus\n    }\n  }\n"]);return u=function(){return n},n}function o(){var n=i()(["\n  mutation ResendTempPwdMutation($id: ID!){\n    resetUserTempPwd(where: {id : $id}) {\n      id\n    }\n  }\n"]);return o=function(){return n},n}function c(){var n=i()(["\n  mutation DisableUserMutation($id: ID!){\n    disableUser(where: {id: $id}) {\n      id\n      disabled\n    }\n  }\n"]);return c=function(){return n},n}function d(){var n=i()(["\n  mutation EnableUserMutation($id: ID!){\n    enableUser(where: {id: $id}) {\n      id\n      disabled\n    }\n  }\n"]);return d=function(){return n},n}function m(){var n=i()(["\n  mutation CreateUserAndAvatarMutation($name: String!, $email: String!, $timezone: String!, $avatarId: ID!, $isAdmin: Boolean, $isTeacher: Boolean, $isStudent: Boolean, $isParent: Boolean, $username: String!, $organization: OrganizationUpdateOneWithoutUsersInput, $state: String) {\n    createUser(\n      data: {\n        name: $name\n        username: $username\n        email: $email\n        timezone: $timezone\n        isAdmin: $isAdmin\n        isTeacher: $isTeacher\n        isStudent: $isStudent\n        isParent: $isParent\n        avatar: {\n          connect: { id: $avatarId }\n        }\n        organization: $organization\n        state: $state\n      }\n    ){\n      ...UserFragment\n    }\n  }\n  ","\n"]);return m=function(){return n},n}function l(){var n=i()(["\n  mutation CreateUserMutation($name: String!, $email: String!, $timezone: String!, $isAdmin: Boolean, $isTeacher: Boolean, $isStudent: Boolean, $isParent: Boolean, $username: String!, $organization: OrganizationUpdateOneWithoutUsersInput, $state: String){\n    createUser(\n      data: {\n        name: $name\n        username: $username\n        email: $email\n        timezone: $timezone\n        isAdmin: $isAdmin\n        isTeacher: $isTeacher\n        isStudent: $isStudent\n        isParent: $isParent\n        organization: $organization\n        state: $state\n      }\n    ){\n      ...UserFragment\n    }\n  }\n  ","\n"]);return l=function(){return n},n}function g(){var n=i()(["\n  mutation UpdateProfileMutation($name: String!, $timezone: String!, $avatarId: ID!, $isAdmin: Boolean, $isTeacher: Boolean, $isStudent: Boolean, $isParent: Boolean, $state: String) {\n    updateProfile(\n      data: {\n        name: $name\n        timezone: $timezone\n        isAdmin: $isAdmin\n        isTeacher: $isTeacher\n        isStudent: $isStudent\n        isParent: $isParent\n        avatar: {\n          connect: { id: $avatarId }\n        }\n        state: $state\n      }\n    ){\n      ...UserFragment\n    }\n  }\n  ","\n"]);return g=function(){return n},n}function f(){var n=i()(["\n  mutation UpdateProfileMutation($name: String!, $timezone: String!, $isAdmin: Boolean, $isTeacher: Boolean, $isStudent: Boolean, $isParent: Boolean, $state: String) {\n    updateProfile(\n      data: {\n        name: $name\n        timezone: $timezone\n        isAdmin: $isAdmin\n        isTeacher: $isTeacher\n        isStudent: $isStudent\n        isParent: $isParent\n        state: $state\n      }\n    ){\n      ...UserFragment\n    }\n  }\n  ","\n"]);return f=function(){return n},n}function h(){var n=i()(["\n  mutation updateUserMutation($name: String!, $timezone: String!, $id: ID!, $avatarId: ID!, $isAdmin: Boolean, $isTeacher: Boolean, $isStudent: Boolean, $isParent: Boolean, $organization: OrganizationUpdateOneWithoutUsersInput, $state: String) {\n    updateUser(\n      where: {id: $id}\n      data: {\n        name: $name\n        timezone: $timezone\n        isAdmin: $isAdmin\n        isTeacher: $isTeacher\n        isStudent: $isStudent\n        isParent: $isParent\n        avatar: {\n          connect: { id: $avatarId }\n        }\n        organization: $organization\n        state: $state\n      }\n    ){\n      ...UserFragment\n    }\n  }\n  ","\n"]);return h=function(){return n},n}function p(){var n=i()(["\n  mutation updateUserMutation($name: String!, $timezone: String!, $id: ID!, $isAdmin: Boolean, $isTeacher: Boolean, $isStudent: Boolean, $isParent: Boolean, $organization: OrganizationUpdateOneWithoutUsersInput, $state: String) {\n    updateUser(\n      where: {id: $id}\n      data: {\n        name: $name\n        timezone: $timezone\n        isAdmin: $isAdmin\n        isTeacher: $isTeacher\n        isStudent: $isStudent\n        isParent: $isParent\n        organization: $organization\n        state: $state\n      }\n    ){\n      ...UserFragment\n    }\n  }\n  ","\n"]);return p=function(){return n},n}function $(){var n=i()(["\n  mutation deleteUserMutation($id: ID!) {\n    deleteUser(where: {id: $id }) {\n      id\n    }\n  }\n"]);return $=function(){return n},n}function v(){var n=i()(["\n  query me {\n    me {\n      id\n      sub\n      name\n      email\n      timezone\n      disabled\n      avatar {\n        id\n        url\n        secret\n      }\n      organization {\n        id\n        name\n      }\n      isAdmin\n      isTeacher\n      isStudent\n      isParent\n      isPublisher\n      username\n    }\n  }\n"]);return v=function(){return n},n}function S(){var n=i()(["\n  query ProfileQuery {\n    user: profile {\n      ...UserFragment\n    }\n  }\n  ","\n"]);return S=function(){return n},n}function w(){var n=i()(["\n  query userQuery($id: ID!) {\n    user( where: {id: $id} ) {\n      ...UserFragment\n    }\n  }\n  ","\n"]);return w=function(){return n},n}function y(){var n=i()(["\n  subscription UsersSubscription {\n    userSubscription {\n      mutation\n      node {\n        id\n        sub\n        name\n        email\n        avatar {\n          id\n          url\n          secret\n        }\n        createdAt\n        updatedAt\n        isAdmin\n        isTeacher\n        isParent\n        isStudent\n        disabled\n      }\n      previousValues {\n        id\n      }\n    }\n  }\n"]);return y=function(){return n},n}function b(){var n=i()(["\n  query TeachersQuery($first: Int, $after: String) {\n    teachers(orderBy: name_ASC, first: $first, after: $after) {\n      ...UserFragment\n    }\n  }\n  ","\n"]);return b=function(){return n},n}function z(){var n=i()(["\n  query OrgUsersQuery($first: Int, $after: String) {\n    orgUsers(orderBy: name_ASC, first: $first, after: $after) {\n      ...UserFragment\n    }\n  }\n  ","\n"]);return z=function(){return n},n}function U(){var n=i()(["\n  query SignupEnabled {\n    signupEnabled {\n      isEnabled\n      message\n    }\n  }\n"]);return U=function(){return n},n}function _(){var n=i()(["\n  query AllUsersQuery($first: Int, $skip: Int, $where: UserWhereInput) {\n    users(orderBy: name_ASC, first: $first, skip: $skip, where: $where) {\n      id\n      name\n      organization {\n        id\n        name\n      }\n    }\n  }\n"]);return _=function(){return n},n}function A(){var n=i()(["\n  query NumUsersQuery($where: UserWhereInput) {\n    numUsers(where: $where)\n  }\n"]);return A=function(){return n},n}function q(){var n=i()(["\n  query AllUsersQuery($first: Int, $skip: Int, $where: UserWhereInput) {\n    users(orderBy: name_ASC, first: $first, skip: $skip, where: $where) {\n      ...UserFragment\n      awsStatus\n    }\n  }\n  ","\n"]);return q=function(){return n},n}function O(){var n=i()(["\n  fragment UserFragment on User {\n    id\n    name\n    email\n    avatar {\n      id\n      url\n      secret\n    }\n    createdAt\n    updatedAt\n    isAdmin\n    isTeacher\n    isParent\n    isStudent\n    disabled\n    username\n    timezone\n    state\n    organization {\n      id\n      name\n    }\n  }\n"]);return O=function(){return n},n}var I=s()(O()),k=s()(q(),I),x=s()(A()),T=s()(_()),B=s()(U()),C=s()(z(),I),P=s()(b(),I),D=(s()(y()),s()(w(),I)),M=s()(S(),I),F=s()(v()),j=s()($()),R=s()(p(),I),W=s()(h(),I),Y=s()(f(),I),E=s()(g(),I),Q=s()(l(),I),N=s()(m(),I),J=s()(d()),H=s()(c()),L=s()(o()),V=s()(u())},"398a":function(n,e,t){"use strict";t.d(e,"h",function(){return b}),t.d(e,"e",function(){return z}),t.d(e,"a",function(){return U}),t.d(e,"g",function(){return _}),t.d(e,"f",function(){return A}),t.d(e,"i",function(){return q}),t.d(e,"d",function(){return O}),t.d(e,"k",function(){return I}),t.d(e,"b",function(){return k}),t.d(e,"c",function(){return x}),t.d(e,"j",function(){return T});var r=t("5640"),i=t.n(r),a=t("9530"),s=t.n(a),u=t("de9e");function o(){var n=i()(["\n  mutation resendOrgSignupMutation($email: String!) {\n    resendOrgSignup(\n      where: {\n        email: $email\n      }\n    )\n  }\n"]);return o=function(){return n},n}function c(){var n=i()(["\n  query orgSignupsQuery {\n    orgSignups(\n      orderBy: name_ASC\n    ) {\n      id\n      name\n      email\n    }\n  }\n"]);return c=function(){return n},n}function d(){var n=i()(["\n  mutation CreateOrgSignupMutation($name: String!, $email: String!) {\n    createOrgSignup(\n      data: {\n        name: $name\n        email: $email\n      }\n    ) {\n      id\n      emailInUse\n    }\n  }\n"]);return d=function(){return n},n}function m(){var n=i()(["\n  mutation CreateOrgMutation($name: String!, $logo: FileCreateOneInput, $orgType: [ID!], $annualBudget: String, $programSize: String, $state: String) {\n    createOrganization(\n      data: {\n        name: $name\n        logo: $logo\n        orgType: $orgType\n        programSize: $programSize\n        annualBudget: $annualBudget\n        state: $state\n      }\n    ) {\n      ...OrgFragment\n    }\n  }\n  ","\n"]);return m=function(){return n},n}function l(){var n=i()(["\n  mutation UpdateOrgMutation($id: ID!, $name: String, $logo: FileUpdateOneInput, $orgType: [ID!], $annualBudget: String, $programSize: String, $state: String) {\n    updateOrganization(\n      where: {id: $id }\n      data: {\n        name: $name\n        logo: $logo\n        orgType: $orgType\n        programSize: $programSize\n        annualBudget: $annualBudget\n        state: $state\n      }\n    ) {\n      ...OrgFragment\n    }\n  }\n  ","\n"]);return l=function(){return n},n}function g(){var n=i()(["\n  mutation DeleteOrgMutation($id: ID!) {\n    deleteOrganization(where: {id: $id }) {\n      id\n    }\n  }\n"]);return g=function(){return n},n}function f(){var n=i()(["\n  query OrgQuery($id: ID!) {\n    organization(\n      where: {id: $id}\n    ) {\n      createdBy {\n        id\n        name\n      }\n      ...OrgFragment\n    }\n  }\n  ","\n"]);return f=function(){return n},n}function h(){var n=i()(["\n  query OrgDropdownQuery($types: [String!]!) {\n    organizations(\n      orderBy: name_ASC\n      where: {\n        types_some: {\n          name_in: $types\n        }\n      }\n    ) {\n      id\n      name\n    }\n  }\n"]);return h=function(){return n},n}function p(){var n=i()(["\n  query OrgDropdownQuery($where: OrganizationWhereInput, $first: Int, $skip: Int) {\n    organizations(\n      orderBy: name_ASC\n      where: $where\n      first: $first\n      skip: $skip\n    ) {\n      id\n      name\n      types {\n        id\n        name\n      }\n    }\n  }\n"]);return p=function(){return n},n}function $(){var n=i()(["\n  query AllOrgsQuery($first: Int, $skip: Int, $where: OrganizationWhereInput) {\n    organizations(orderBy: name_ASC, first: $first, skip: $skip, where: $where) {\n      ...OrgFragment\n      createdAt\n      updatedAt\n    }\n  }\n  ","\n"]);return $=function(){return n},n}function v(){var n=i()(["\n  query NumOrgsQuery($where: OrganizationWhereInput) {\n    numOrgs(where: $where)\n  }\n"]);return v=function(){return n},n}function S(){var n=i()(["\n  query OrgNameQuery($search: String!) {\n    organizations(\n      orderBy: name_ASC\n      where: {name_contains: $search }\n    ) {\n      id\n      name\n    }\n  }\n"]);return S=function(){return n},n}function w(){var n=i()(["\n  fragment OrgFragment on Organization {\n    id\n    name\n    state\n    programSize\n    annualBudget\n    types {\n      id\n      name\n    }\n    logo {\n      ...FileFragment\n    }\n  }\n  ","\n"]);return w=function(){return n},n}var y=s()(w(),u["k"]),b=s()(S()),z=s()(v()),U=s()($(),y),_=s()(p()),A=s()(h()),q=s()(f(),y),O=s()(g()),I=s()(l(),y),k=s()(m(),y),x=s()(d()),T=(s()(c()),s()(o()))},"41e2":function(n,e,t){},"5b03":function(n,e,t){},"66a3":function(n,e,t){"use strict";var r=t("5b03"),i=t.n(r);i.a},7524:function(n,e,t){"use strict";t.r(e);var r=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("q-page",[t("loading",{attrs:{firstOnly:"",query:n.$apollo.queries.users}},[t("scroll",{attrs:{paging:!1}},[n.users.length?t("q-list",{attrs:{separator:""}},n._l(n.users,function(e){return t("q-item",{key:e.id,staticClass:"items-start user-list-item",class:n.itemClass(e),attrs:{to:"/users/"+e.id}},[t("q-item-side",{attrs:{inverted:"",letter:e.avatar?null:e.name[0],color:"grey-6"}},[e.avatar?t("q-item-tile",{attrs:{avatar:""}},[t("aws-image",{attrs:{src:e.avatar}})],1):n._e()],1),t("q-item-main",[t("q-item-tile",{staticClass:"q-mb-xs",attrs:{label:""}},[n._v(n._s(e.name)),e.disabled?[n._v(" (disabled)")]:n._e()],2),t("q-item-tile",{staticClass:"text-weight-medium q-mb-xs"},[n._v(n._s(e.email))]),e.organization?t("q-item-tile",{staticClass:"text-weight-medium q-mb-xs"},[n._v(n._s(e.organization.name))]):n._e(),t("q-item-tile",{staticClass:"text-weight-medium q-mb-md"},[n._v("Created "+n._s(n.formatDate(e.createdAt,"MM/DD/YYYY")))]),t("q-item-tile",{staticClass:"text-grey-7 row icon-row"},[e.isAdmin?t("span",{staticClass:"justify-center ellipsis-2-lines q-mr-md q-mb-md"},[t("q-icon",{attrs:{name:n.icons["ADMIN"]}}),n._v(" \n              ")],1):n._e(),e.isAdmin?t("span",{staticClass:"justify-center ellipsis-2-lines q-mr-md"},[t("q-icon",{attrs:{name:n.icons["TEACHER"]}}),n._v(" \n              ")],1):n._e(),e.isAdmin?t("span",{staticClass:"justify-center ellipsis-2-lines q-mr-md"},[t("q-icon",{attrs:{name:n.icons["STUDENT"]}}),n._v(" \n              ")],1):n._e(),e.isAdmin?t("span",{staticClass:"justify-center ellipsis-2-lines q-mr-md"},[t("q-icon",{attrs:{name:n.icons["PARENT"]}}),n._v(" \n              ")],1):n._e()]),t("q-item-tile",{staticClass:"text-grey-7 icon-row q-caption"},[t("div",{staticClass:"text-weight-bolder"},[n._v("\n                AWS Status:\n              ")]),e.awsStatus?[t("div",[n._v("Enabled: "+n._s(e.awsStatus.Enabled))]),t("div",[n._v("User Status: "+n._s(e.awsStatus.UserStatus))])]:[n._v("\n                User not found in AWS\n              ")]],2)],1)],1)})):t("div",[t("q-alert",{staticClass:"q-mb-sm",attrs:{color:"info",icon:"error",appear:""}},[n._v("\n          There are no users under the selected organization.\n        ")])],1)],1)],1),n.users.length?t("q-layout-footer",[t("q-pagination",{staticClass:"row justify-center",attrs:{min:1,max:n.numPages,"direction-links":"","max-pages":10},model:{value:n.page,callback:function(e){n.page=e},expression:"page"}})],1):n._e(),t("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[t("q-fab",{ref:"newUserButton",staticClass:"white",attrs:{color:"primary",icon:"person add"},on:{show:function(e){n.$router.push("/users/new")}}})],1),t("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,90]}},[t("q-btn",{attrs:{color:"secondary",icon:"fa fa-file-csv",round:"",dense:"",size:"xl",loading:n.exporting},on:{click:n.exportUsers}})],1)],1)},i=[];r._withStripped=!0;t("ac6a"),t("cadf"),t("456d"),t("7f7f"),t("386d");var a=t("3156"),s=t.n(a),u=t("0374"),o=t("398a"),c=t("f490"),d=t("b0d5"),m=t("1fe0"),l=t("2743"),g=t("fcab"),f=t("2f62"),h=c["d"].formatDate,p={name:"Users",mixins:[l["a"]],components:{awsImage:g["a"]},data:function(){return{pageSize:40,page:1,numUsers:0,users:[],organizations:[],lastId:null,exporting:!1,search:null}},computed:s()({numPages:function(){return Math.ceil(this.numUsers/this.pageSize)}},Object(f["c"])("app",["currentOption","searchString"])),watch:{currentOption:{handler:function(){this.page=1}},searchString:{handler:function(n){this.setSearch(n)}}},created:function(){this.setSearch=Object(m["a"])(this.setSearch,500)},methods:{setSearch:function(n){this.page=1,this.search=n},formatDate:function(n){return h(n,"M/D/YYYY")},itemClass:function(n){return n.disabled?"text-weight-light":""},exportUsers:function(){var n=this;if(!this.exporting){this.exporting=!0;var e={first:1e4};this.currentOption&&(e.where={organization:{id:this.currentOption}}),this.search&&(e.where||(e.where={}),e.where.OR=[{email_contains:this.search},{name_contains:this.search}]),this.$apollo.query({query:u["a"],variables:e}).then(function(e){var t=e.data.users.map(function(n){var e=Object(d["a"])({},n),t=e.awsStatus;return e.organization=e.organization&&e.organization.name,e.aws=t?t.UserStatus:"Not in AWS",delete e.awsStatus,delete e.avatar,delete e.__typename,e.createdAt=h(e.createdAt,"M/D/YYYY HH:mm:ss"),e.updatedAt=h(e.updatedAt,"M/D/YYYY HH:mm:ss"),e}),r=n.convertJsonToCSV(t);n.downloadReport(r),n.exporting=!1})}},convertJsonToCSV:function(n){var e=function(n,e){return null===e?"":e},t=Object.keys(n[0]),r=n.map(function(n){return t.map(function(t){return JSON.stringify(n[t],e)}).join(",")});return r.unshift(t.join(",")),r=r.join("\r\n"),r},downloadReport:function(n){var e=window.URL.createObjectURL(new Blob([n])),t=document.createElement("a");t.href=e,t.setAttribute("download","report_analysis.csv"),document.body.appendChild(t),t.click()}},apollo:{numUsers:{query:u["i"],fetchPolicy:"cache-and-network",variables:function(){var n={};return this.currentOption&&(n.where={organization:{id:this.currentOption}}),this.search&&(n.where||(n.where={}),n.where.OR=[{email_contains:this.search},{name_contains:this.search}]),n}},users:{query:u["a"],variables:function(){var n={first:this.pageSize,skip:(this.page-1)*this.pageSize};return this.currentOption&&(n.where={organization:{id:this.currentOption}}),this.search&&(n.where||(n.where={}),n.where.OR=[{email_contains:this.search},{name_contains:this.search}]),n},fetchPolicy:"cache-and-network"},organizations:{query:o["g"],fetchPolicy:"cache-and-network",variables:function(){return{where:{users_some:{id_gt:"0"}}}},update:function(n){var e=n.organizations,t=e.map(function(n){return{value:n.id,label:n.name}});this.$store.commit("app/setOptions",t)}}}},$=p,v=(t("66a3"),t("2877")),S=Object(v["a"])($,r,i,!1,null,null,null);S.options.__file="UserList.vue";e["default"]=S.exports},"7d7e":function(n,e,t){"use strict";t.d(e,"a",function(){return o});var r=t("5640"),i=t.n(r),a=t("9530"),s=t.n(a);function u(){var n=i()(["\n  mutation ConvertImageMutation($key: String!, $tag: String!, $width: Int!){\n    convertImage(\n      key: $key\n      tag: $tag\n      width: $width\n    ){\n      success\n      error\n      info\n    }\n  }\n"]);return u=function(){return n},n}var o=s()(u())},bd43:function(n,e,t){"use strict";var r=t("41e2"),i=t.n(r);i.a},fcab:function(n,e,t){"use strict";var r=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"fill"},[n.imageUrl?t("img",{attrs:{src:n.imageUrl}}):n._e()])},i=[];r._withStripped=!0;t("96cf");var a=t("c973"),s=t.n(a),u=(t("c5f6"),t("9755")),o=t("d67a"),c=t("7d7e"),d={name:"awsImage",props:{src:Object,default:String,expires:{type:Number,default:86400},tag:String,imageWidth:Number},methods:{tokenExpired:function(){var n=s()(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,o["a"].dispatch("getCurrentSession");case 2:if(e=n.sent.getAccessToken().getJwtToken(),this.$store.state.app.jwtToken!==e){n.next=5;break}return n.abrupt("return",!1);case 5:return this.$store.dispatch("app/setJwtToken",e),n.abrupt("return",!0);case 7:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),cachedUrl:function(){var n=s()(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:if(!this.src.url){n.next=2;break}return n.abrupt("return",this.src.url);case 2:return n.next=4,this.tokenExpired();case 4:if(!n.sent){n.next=7;break}return this.$store.dispatch("app/clearAwsCache"),n.abrupt("return");case 7:return n.abrupt("return",this.$store.getters["app/getAwsUrl"](this.awsSecret));case 8:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),generateThumbnail:function(){var n=s()(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,this.$apollo.mutate({mutation:c["a"],variables:{key:this.src.secret,tag:this.tag,width:this.imageWidth}});case 2:return e=n.sent,n.abrupt("return",e);case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}()},computed:{isThumbnail:function(){return!!(this.src.secret&&this.tag&&this.imageWidth)},awsSecret:function(){return this.isThumbnail?"".concat(this.src.secret,"_").concat(this.tag):this.src.secret}},asyncComputed:{imageUrl:function(){var n=s()(regeneratorRuntime.mark(function n(){var e,t,r,i,a;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:if(this.src){n.next=2;break}return n.abrupt("return",this.default);case 2:return n.next=4,this.cachedUrl();case 4:if(e=n.sent,!e){n.next=7;break}return n.abrupt("return",e);case 7:if(!this.awsSecret){n.next=24;break}if(r=this.awsSecret,!this.isThumbnail){n.next=18;break}return n.next=12,u["a"].list(this.awsSecret);case 12:if(i=n.sent,i.length){n.next=18;break}return n.next=16,this.generateThumbnail();case 16:a=n.sent,a&&a.data&&a.data.convertImage&&a.data.convertImage.success||(r=this.src.secret);case 18:return n.next=20,u["a"].get(r,{expires:this.expires});case 20:return e=n.sent,t=(new Date).getTime()+1e3*(this.expires-60),this.$store.dispatch("app/cacheAwsUrl",{key:this.awsSecret,expiration:t,url:e}),n.abrupt("return",e);case 24:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}()}},m=d,l=(t("bd43"),t("2877")),g=Object(l["a"])(m,r,i,!1,null,null,null);g.options.__file="awsImage.vue";e["a"]=g.exports}}]);